# Work Log - Bookmark Deck

Этот файл отслеживает текущее состояние разработки проекта.

## Текущий статус

**Фаза**: Chrome Extension v1.0
**Последнее обновление**: 2026-01-28

---

## Chrome Extension v1.0

### Возможности доступа
1. **Новая вкладка** — Bookmark Deck заменяет стартовую страницу Chrome
2. **Оверлей** — `Alt+B` открывает оверлей поверх любой страницы
3. **Иконка** — клик по иконке расширения в toolbar

### Функциональность
- [x] Оверлей поверх любой страницы
- [x] Override New Tab — Bookmark Deck на стартовой странице
- [x] Открытие по горячей клавише Alt+B или клику на иконку
- [x] Закрытие оверлея: Escape, клик вне оверлея, переход по ссылке
- [x] При клике на закладку — открытие URL в новой вкладке
- [x] При копировании URL (Ctrl+Click) — копирование в буфер
- [x] Хранение данных в chrome.storage.local (синхронизация между вкладками)

### Файлы расширения
```
extension/
├── manifest.json      # Manifest V3
├── background.js      # Service worker
├── content.js         # Внедрение оверлея
├── overlay.html       # HTML страница оверлея
├── newtab.html        # HTML для новой вкладки
├── assets/            # Собранный JS/CSS
│   ├── extension.js
│   ├── newtab.js
│   ├── shared-extensionBookmarkStore.js
│   └── *.css
└── icons/             # Иконки расширения
    ├── icon.svg
    └── icon{16,32,48,128}.png
```

### Исходные файлы
- `src/extension/` — оверлей (ExtensionApp.vue, main.js)
- `src/newtab/` — новая вкладка (NewTabApp.vue, main.js)
- `src/stores/extensionBookmarkStore.js` — store с chrome.storage
- `src/composables/useExtensionStorage.js` — работа с chrome.storage.local
- `vite.config.extension.js` — конфиг сборки расширения

### Команды
```bash
npm run build:extension   # Собрать расширение
npm run dev:extension     # Собрать с watch-режимом
npm run generate-icons    # Сгенерировать PNG иконки из SVG
```

### Установка в Chrome
1. Открыть `chrome://extensions/`
2. Включить "Режим разработчика"
3. "Загрузить распакованное расширение"
4. Выбрать папку `extension/`

---

## План доработок v1.2

Источник требований: `/docs/fixes.md`

### Этап 1: Исправления в буфере
- [x] 1.1 Убрать знак "+" с пустых ячеек буфера

### Этап 2: Исправления в корзине
- [x] 2.1 Убрать hover-анимацию увеличения блока (вызывает появление скролла)
- [x] 2.2 Фиксированная сетка 4×4 (максимум 16 блоков без скролла)
- [x] 2.3 При количестве блоков > 16 — вертикальный скролл

### Этап 3: Исправление подсветки при drag-n-drop из корзины
- [x] 3.1 Подсвечивать drop-target только на панели, над которой находится курсор
- [x] 3.2 Не подсвечивать ячейки с одинаковыми координатами на разных панелях

### Этап 4: Выравнивание табов в нормальном режиме
- [x] 4.1 Добавить отступ/рамку для выравнивания табов с режимом редактирования

### Этап 5: Исправление удаления блоков из буфера
- [x] 5.1 Кнопка "Удалить" при редактировании блока из буфера теперь работает корректно
- [x] 5.2 Добавлен метод updateBufferBlock в store для редактирования блоков буфера

---

## Заметки

### Технические решения
- Использовать `crypto.randomUUID()` для генерации ID
- Для drag-n-drop рассмотреть HTML5 Drag and Drop API или библиотеку vuedraggable
- Цвета хранить как строковые идентификаторы, маппинг в utils/colors.js
- Tailwind CSS 4: используется @theme для кастомных цветов в style.css

### Структура проекта (создана)
```
src/
├── components/
│   ├── layout/
│   ├── tabs/
│   ├── grid/
│   ├── buffer/
│   ├── modals/
│   ├── ui/
│   └── common/
├── composables/
├── stores/
├── utils/
├── App.vue
├── main.js
└── style.css
```

### Отложенные фичи (не включать в v1)
- Селектор иконок (поле icon зарезервировано)
- Поиск по закладкам
- Импорт из браузера
- Облачная синхронизация
- Светлая тема
- Мобильная адаптация

---

## История версий

### v1.1 (завершено 2026-01-27)

**Доработки UI/UX:**
- Табы оформлены как pills, выровнены по левому краю
- Размер блока увеличен до 88px, отступы до 12px
- Расширенная палитра — 32 цвета
- Убран hover для пустых ячеек в основном режиме

**Буфер:**
- Панель 3×4 справа от основной сетки
- Поддержка copy/cut/paste операций
- Перетаскивание в корзину

**Корзина:**
- Отображение блоками в сетке 4 колонки
- Drag-n-drop в буфер и на панель
- Закрытие по клику вне попапа

**Режим редактирования:**
- Alt+Click — в буфер, Alt+Shift+Click — в корзину
- Динамический курсор по модификаторам
- Информационный блок clipboard с превью

**Прочее:**
- Закрытие модальных окон по Esc
- Автофокус при создании таба
- Ctrl+Click в основном режиме копирует URL
- При удалении вкладки блоки идут в корзину

### v1.0 (завершено 2026-01-26)

Все 11 этапов разработки успешно выполнены.

**Основные возможности:**
- Сетка закладок 8×4 (32 ячейки на страницу)
- До 8 табов с drag-n-drop переупорядочиванием
- 16 цветов/градиентов для блоков
- Режим редактирования с полным CRUD
- Drag-n-drop блоков между ячейками
- Контекстное меню при конфликтах (swap/buffer/delete)
- Буфер и корзина с восстановлением
- Clipboard операции (Ctrl+клик copy, Shift+клик cut)
- Экспорт/импорт в JSON
- Сброс к defaults
- Темная тема с neon-эффектами
- Accessibility support
- Полная локализация на русский язык

---

## Команды
```bash
npm run dev      # Dev-сервер
npm run build    # Production сборка
npm run preview  # Превью production
```
