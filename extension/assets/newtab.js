import{_ as pe,u as he,s as be,o as Te,n as c,c as h,b,F as Be,d as i,e as ke,f as o,g as Ce,h as y,i as ge,j as T,B as xe,p as we,k as ye,l as _e,C as Me,I as De,H as Ee,w as $e,t as Fe,T as Ae,A as Ie,r as n,q as Se,m as Ne,v as Re,x as He,y as Ue,z as je}from"./shared-extensionBookmarkStore.js";const Oe={class:"newtab-container min-h-screen flex flex-col bg-bg-primary text-text-primary"},Pe={key:0,class:"flex-1 flex items-center justify-center"},Ve={class:"flex-1 flex items-start justify-center p-6 pb-20 pt-8"},ze={class:"flex items-start gap-8"},qe={class:"mb-4"},Le={key:0,class:"flex flex-col gap-4"},Ge={key:0,class:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 px-4 py-2 rounded-lg bg-bg-secondary ring-1 ring-neon-cyan/50 shadow-lg shadow-neon-cyan/20 text-sm text-text-primary"},Je={__name:"NewTabApp",setup(We){const a=he(),{activeBlocks:F,activeTab:u,activeTabId:A,sortedTabs:_,canAddTab:I,canDeleteTab:S,buffer:B,trash:M,trashBlockCount:Xe,trashTabCount:N,tabs:R}=be(a),{startDragFromBuffer:H,draggedFromBuffer:U}=He(),{copy:j,cut:O}=Re(),{isEditMode:m}=Se(),D=n(!0),v=n(!1),t=n(null),d=n(null),f=n(!1),s=n(!1),r=n({title:"",message:"",confirmText:"Подтвердить",danger:!1,onConfirm:()=>{}}),k=n(!1),C=n(!1),g=n(null),E=n(""),x=n(!1);let w=null;function P(e){E.value=e,x.value=!0,w&&clearTimeout(w),w=setTimeout(()=>{x.value=!1},2e3)}const V=Ne(()=>({tabs:R.value,buffer:B.value,trash:M.value}));Te(async()=>{await a.init(),D.value=!1});function z(e){m.value&&(t.value=null,d.value=e,f.value=!1,v.value=!0)}function q(e){m.value?(t.value=e,d.value=e.position,f.value=!1,v.value=!0):window.open(e.url,"_blank")}function L({block:e,tabId:l}){B.value.length>=12||a.moveToBuffer(l,e.id)}function G({block:e,tabId:l}){a.deleteBlock(l,e.id)}function J({block:e}){P(`Ссылка скопирована: ${e.title}`)}function K(e){t.value?f.value?a.updateBufferBlock(t.value.id,e):a.updateBlock(u.value.id,t.value.id,e):a.addBlock(u.value.id,d.value,e),v.value=!1,t.value=null,d.value=null,f.value=!1}function Q(){t.value&&(r.value={title:"Удалить закладку",message:`Вы уверены, что хотите удалить "${t.value.title}"?`,confirmText:"Удалить",danger:!0,onConfirm:()=>{f.value?a.deleteFromBuffer(t.value.id):a.deleteBlock(u.value.id,t.value.id),v.value=!1,s.value=!1,t.value=null,d.value=null,f.value=!1}},s.value=!0)}function W(){v.value=!1,t.value=null,d.value=null,f.value=!1}function X(e){a.setActiveTab(e)}function Y(){const e=a.addTab();e&&(g.value=e.id)}function Z(){g.value=null}function ee({id:e,name:l}){a.updateTab(e,{name:l})}function ae(e){const l=_.value.find(p=>p.id===e);l&&(r.value={title:"Удалить вкладку",message:`Вы уверены, что хотите удалить "${l.name}"? Все закладки этой вкладки будут перемещены в корзину.`,confirmText:"Удалить",danger:!0,onConfirm:()=>{a.deleteTab(e),s.value=!1}},s.value=!0)}function le({fromIndex:e,toIndex:l}){a.reorderTabs(e,l)}function te(e){H(e)}function oe(e){u.value&&a.moveToBuffer(u.value.id,e.id)}function ne(e){t.value=e,d.value=null,f.value=!0,v.value=!0}function se({block:e}){j(e,null,!0)}function ue({block:e}){O(e,null,!0)}function re({block:e}){a.deleteFromBuffer(e.id)}function ie({trashIndex:e}){a.restoreBlockToBuffer(e)}function de(e){U.value?a.deleteFromBuffer(e.id):u.value&&a.deleteBlock(u.value.id,e.id)}function fe(){r.value={title:"Очистить корзину",message:"Вы уверены, что хотите безвозвратно удалить все элементы из корзины? Это действие нельзя отменить.",confirmText:"Очистить",danger:!0,onConfirm:()=>{a.emptyTrash(),s.value=!1}},s.value=!0}function ce(){k.value=!0}function ve(e){a.importData(e)}function me(){r.value={title:"Сбросить все данные",message:"Вы уверены, что хотите сбросить все данные? Все ваши закладки, вкладки и настройки будут удалены. Это действие нельзя отменить.",confirmText:"Сбросить всё",danger:!0,onConfirm:()=>{a.reset(),s.value=!1}},s.value=!0}return(e,l)=>(c(),h("div",Oe,[D.value?(c(),h("div",Pe,[...l[4]||(l[4]=[b("div",{class:"text-text-secondary"},"Загрузка...",-1)])])):(c(),h(Be,{key:1},[i(ke,{onOpenImportExport:ce,onResetAll:me,onOpenHelp:l[0]||(l[0]=p=>C.value=!0)}),b("main",Ve,[b("div",ze,[b("div",null,[b("div",qe,[i(Ce,{tabs:o(_),"active-tab-id":o(A),"can-add-tab":o(I),"can-delete-tab":o(S),"edit-mode":o(m),"new-tab-id":g.value,onSelect:X,onCreate:Y,onUpdate:ee,onDelete:ae,onReorder:le,onEditComplete:Z},null,8,["tabs","active-tab-id","can-add-tab","can-delete-tab","edit-mode","new-tab-id"])]),o(u)?(c(),y(ge,{key:0,blocks:o(F),"tab-id":o(u).id,"edit-mode":o(m),onCellClick:z,onBlockClick:q,onMoveToBuffer:L,onMoveToTrash:G,onUrlCopied:J},null,8,["blocks","tab-id","edit-mode"])):T("",!0)]),o(m)?(c(),h("div",Le,[i(xe,{blocks:o(B),onBlockDragStart:te,onDrop:oe,onDropFromTrash:ie,onBlockClick:ne,onCopy:se,onCut:ue,onMoveToTrash:re},null,8,["blocks"]),i(we)])):T("",!0)])]),o(m)?(c(),y(ye,{key:0,"trash-blocks":o(M).blocks,"trash-tab-count":o(N),onTrashDrop:de,onTrashEmpty:fe},null,8,["trash-blocks","trash-tab-count"])):T("",!0),i(_e,{show:v.value,block:t.value,position:d.value,onSave:K,onDelete:Q,onCancel:W},null,8,["show","block","position"]),i(Me,{show:s.value,title:r.value.title,message:r.value.message,"confirm-text":r.value.confirmText,danger:r.value.danger,onConfirm:r.value.onConfirm,onCancel:l[1]||(l[1]=p=>s.value=!1)},null,8,["show","title","message","confirm-text","danger","onConfirm"]),i(De,{show:k.value,"current-data":V.value,onClose:l[2]||(l[2]=p=>k.value=!1),onImport:ve},null,8,["show","current-data"]),i(Ee,{show:C.value,onClose:l[3]||(l[3]=p=>C.value=!1)},null,8,["show"]),(c(),y(Ie,{to:"body"},[i(Ae,{name:"toast"},{default:$e(()=>[x.value?(c(),h("div",Ge,Fe(E.value),1)):T("",!0)]),_:1})]))],64))]))}},Ke=pe(Je,[["__scopeId","data-v-5116028b"]]),$=Ue(Ke),Qe=je();$.use(Qe);$.mount("#app");
